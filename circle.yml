machine:
  services:
    - postgresql
  pre:
    - mkdir -p $HOME/.go_project/src/github.com/oursky
    - mv ourd $HOME/.go_project/src/github.com/oursky/
    - ln -s $HOME/.go_project/src/github.com/oursky/ourd .

dependencies:
  post:
    - >
      go get golang.org/x/tools/cmd/cover \
             github.com/golang/lint/golint \
             github.com/smartystreets/goconvey/convey \
             github.com/smartystreets/assertions \
             golang.org/x/tools/cmd/stringer \
             github.com/rickmak/gocyclo \
             github.com/oursky/gogocyclo

    - go install

test:
  override:
    - golint ./...
    - gocyclo -skip-godeps -over 15 . | gogocyclo
    - go generate ./...
    - go test -cover ./...

database:
  post:
    - psql -c 'CREATE DATABASE ourd_test;' -U ubuntu
